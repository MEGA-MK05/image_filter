# Sobel Edge Detection Filter - ë™ì‘ ì›ë¦¬ ë° í”„ë¡œì„¸ìŠ¤

## ğŸ“‹ ëª©ì°¨
1. [Sobel í•„í„° ê°œìš”](#sobel-í•„í„°-ê°œìš”)
2. [ìˆ˜í•™ì  ì›ë¦¬](#ìˆ˜í•™ì -ì›ë¦¬)
3. [í•˜ë“œì›¨ì–´ ì•„í‚¤í…ì²˜](#í•˜ë“œì›¨ì–´-ì•„í‚¤í…ì²˜)
4. [ë°ì´í„° íë¦„](#ë°ì´í„°-íë¦„)
5. [í•µì‹¬ ëª¨ë“ˆ ìƒì„¸](#í•µì‹¬-ëª¨ë“ˆ-ìƒì„¸)
6. [í…ŒìŠ¤íŠ¸ë²¤ì¹˜ í”„ë¡œì„¸ìŠ¤](#í…ŒìŠ¤íŠ¸ë²¤ì¹˜-í”„ë¡œì„¸ìŠ¤)
7. [ì„±ëŠ¥ ë¶„ì„](#ì„±ëŠ¥-ë¶„ì„)
8. [ìµœì í™” ê¸°ë²•](#ìµœì í™”-ê¸°ë²•)

---

##  Sobel í•„í„° ê°œìš”

### **ì •ì˜**
Sobel í•„í„°ëŠ” **ì—£ì§€ ê²€ì¶œ(Edge Detection)**ì„ ìœ„í•œ **1ì°¨ ë¯¸ë¶„ ì—°ì‚°ì**ë¡œ, ì´ë¯¸ì§€ì˜ ë°ê¸° ë³€í™”ìœ¨ì„ ê³„ì‚°í•˜ì—¬ ê°ì²´ì˜ ê²½ê³„ë¥¼ ì°¾ì•„ë‚´ëŠ” ë””ì§€í„¸ ì´ë¯¸ì§€ ì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.

### **íŠ¹ì§•**
- **ë°©í–¥ì„±**: ìˆ˜í‰(X)ê³¼ ìˆ˜ì§(Y) ë°©í–¥ì˜ ì—£ì§€ë¥¼ ê°ê° ê²€ì¶œ
- **ë…¸ì´ì¦ˆ ì €í•­**: ê°€ìš°ì‹œì•ˆ í•„í„°ë§ íš¨ê³¼ë¡œ ë…¸ì´ì¦ˆì— ê°•í•¨
- **ì‹¤ì‹œê°„ ì²˜ë¦¬**: í•˜ë“œì›¨ì–´ êµ¬í˜„ ì‹œ ê³ ì† ì²˜ë¦¬ ê°€ëŠ¥
- **ì •í™•ë„**: ì—£ì§€ì˜ ìœ„ì¹˜ì™€ ê°•ë„ë¥¼ ì •í™•í•˜ê²Œ ê³„ì‚°

---

##  ìˆ˜í•™ì  ì›ë¦¬

### **1. Sobel ì»¤ë„ (Kernel)**

#### **Xë°©í–¥ ì»¤ë„ (Gx)**
```
Gx = [-1  0  +1]
     [-2  0  +2]
     [-1  0  +1]
```

#### **Yë°©í–¥ ì»¤ë„ (Gy)**
```
Gy = [-1  -2  -1]
     [ 0   0   0]
     [+1  +2  +1]
```

### **2. ì—£ì§€ ê°•ë„ ê³„ì‚°**

#### **ê¸°ë³¸ ê³µì‹**
```
Gx = (P6 + 2Ã—P7 + P8) - (P0 + 2Ã—P1 + P2)
Gy = (P2 + 2Ã—P5 + P8) - (P0 + 2Ã—P3 + P6)
```

#### **ìµœì¢… ì—£ì§€ ê°•ë„**
```
Magnitude = âˆš(GxÂ² + GyÂ²)
```

#### **ë°©í–¥ ì •ë³´**
```
Direction = arctan(Gy / Gx)
```

### **3. ê³ ì •ì†Œìˆ˜ì  ì—°ì‚°**

#### **RGB to Gray ë³€í™˜**
```
Gray = (R Ã— 77 + G Ã— 150 + B Ã— 29) >> 8
```
- **77, 150, 29**: ì¸ê°„ ì‹œê° íŠ¹ì„±ì„ ë°˜ì˜í•œ ê°€ì¤‘ì¹˜
- **>> 8**: 256ìœ¼ë¡œ ë‚˜ëˆ„ê¸° (8ë¹„íŠ¸ ì‹œí”„íŠ¸)

#### **Sobel ì—°ì‚° ìµœì í™”**
```
// ì ˆëŒ“ê°’ ê³„ì‚° (ë¹„êµ ì—°ì‚°ìœ¼ë¡œ ëŒ€ì²´)
if (Gx < 0) Gx_abs = -Gx; else Gx_abs = Gx;
if (Gy < 0) Gy_abs = -Gy; else Gy_abs = Gy;

// ê·¼ì‚¬ê°’ ê³„ì‚° (ì œê³±ê·¼ ëŒ€ì‹ )
Magnitude â‰ˆ max(Gx_abs, Gy_abs) + min(Gx_abs, Gy_abs)/2
```

---

## ğŸ—ï¸ í•˜ë“œì›¨ì–´ ì•„í‚¤í…ì²˜

### **ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Input     â”‚â”€â”€â”€â–¶â”‚ RGB to Gray â”‚â”€â”€â”€â–¶â”‚ 3Ã—3 Line    â”‚â”€â”€â”€â–¶â”‚  Sobel      â”‚
â”‚  Interface  â”‚    â”‚ Conversion  â”‚    â”‚  Buffer     â”‚    â”‚   Core      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   Output    â”‚â—€â”€â”€â”€â”‚ Threshold   â”‚â—€â”€â”€â”€â”‚ Magnitude  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  Interface  â”‚    â”‚  Logic      â”‚    â”‚ Calculationâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **ëª¨ë“ˆë³„ ì—­í• **

#### **1. Input Interface**
- **ë™ê¸°í™” ì‹ í˜¸**: `in_de`, `in_hsync`, `in_vsync`
- **í”½ì…€ ë°ì´í„°**: `in_r`, `in_g`, `in_b` (8ë¹„íŠ¸ ê°ê°)
- **í´ëŸ­ ë„ë©”ì¸**: ì…ë ¥ í´ëŸ­ê³¼ ë™ê¸°í™”

#### **2. RGB to Gray Conversion**
- **ìƒ‰ìƒ ê³µê°„ ë³€í™˜**: RGB â†’ Grayscale
- **ê°€ì¤‘ì¹˜ ì ìš©**: ì¸ê°„ ì‹œê° íŠ¹ì„± ë°˜ì˜
- **ë°ì´í„° ì •ê·œí™”**: 8ë¹„íŠ¸ ì¶œë ¥

#### **3. 3Ã—3 Line Buffer**
- **ë¼ì¸ ì €ì¥**: 3ê°œ ë¼ì¸ì„ ìˆœí™˜ ì €ì¥
- **ìœˆë„ìš° êµ¬ì„±**: 3Ã—3 í”½ì…€ ìœˆë„ìš° ìƒì„±
- **ê²½ê³„ ì²˜ë¦¬**: ì´ë¯¸ì§€ ê²½ê³„ì—ì„œì˜ íŠ¹ìˆ˜ ì²˜ë¦¬

#### **4. Sobel Core**
- **Xë°©í–¥ ê³„ì‚°**: Gx ì»¤ë„ ì ìš©
- **Yë°©í–¥ ê³„ì‚°**: Gy ì»¤ë„ ì ìš©
- **ì ˆëŒ“ê°’ ê³„ì‚°**: ë¶€í˜¸ ì œê±°

#### **5. Magnitude Calculation**
- **ì œê³± ì—°ì‚°**: GxÂ², GyÂ² ê³„ì‚°
- **ì œê³±ê·¼**: âˆš(GxÂ² + GyÂ²) ê³„ì‚°
- **ìµœì í™”**: ê·¼ì‚¬ê°’ ì‚¬ìš©ìœ¼ë¡œ ì†ë„ í–¥ìƒ

#### **6. Threshold Logic**
- **ì´ì§„í™”**: ì„ê³„ê°’ ê¸°ì¤€ ì—£ì§€ íŒì •
- **ì„¤ì • ê°€ëŠ¥**: ë™ì  ì„ê³„ê°’ ì¡°ì •
- **ë…¸ì´ì¦ˆ ì œê±°**: ì•½í•œ ì—£ì§€ í•„í„°ë§

#### **7. Output Interface**
- **ë™ê¸°í™” ì‹ í˜¸**: `out_de`, `out_hsync`, `out_vsync`
- **ê²°ê³¼ ë°ì´í„°**: `out_r`, `out_g`, `out_b`
- **ì§€ì—° ë³´ì •**: íŒŒì´í”„ë¼ì¸ ì§€ì—° ë³´ìƒ

---

## ğŸ”„ ë°ì´í„° íë¦„

### **1. ì…ë ¥ ë‹¨ê³„**
```
Input Pixel â†’ RGB to Gray â†’ Gray Pixel
     â†“              â†“           â†“
   in_rgb      Weighted Sum   gray[7:0]
```

### **2. ë²„í¼ë§ ë‹¨ê³„**
```
Gray Pixel â†’ Line Buffer â†’ 3Ã—3 Window
     â†“           â†“           â†“
  gray[7:0]   line1,2,3   p00~p22
```

### **3. ì²˜ë¦¬ ë‹¨ê³„**
```
3Ã—3 Window â†’ Sobel Core â†’ Magnitude â†’ Threshold â†’ Output
     â†“           â†“           â†“           â†“         â†“
   p00~p22    Gx, Gy     Mag[7:0]   Edge[7:0]  out_rgb
```

### **4. íƒ€ì´ë° ë‹¤ì´ì–´ê·¸ë¨**
```
Clock:    __|â€¾|__|â€¾|__|â€¾|__|â€¾|__|â€¾|__|â€¾|__|â€¾|__|â€¾|__
Input:    ___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___
          P0  P1  P2  P3  P4  P5  P6  P7  P8
Buffer:   ___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___
          B0  B1  B2  B3  B4  B5  B6  B7  B8
Sobel:    ___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___
          S0  S1  S2  S3  S4  S5  S6  S7  S8
Output:   ___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___|â€¾â€¾â€¾|___
          O0  O1  O2  O3  O4  O5  O6  O7  O8
```

---

## ğŸ”§ í•µì‹¬ ëª¨ë“ˆ ìƒì„¸

### **1. RGB to Gray Module**

#### **êµ¬í˜„ ì½”ë“œ**
```verilog
module rgb2gray(
    input wire clk, rst,
    input wire [7:0] in_r, in_g, in_b,
    input wire in_de, in_hsync, in_vsync,
    output reg [7:0] gray,
    output reg de_g, hs_g, vs_g
);
    
    // ê³ ì •ì†Œìˆ˜ì  ê°€ì¤‘ì¹˜ (8ë¹„íŠ¸ ì •ë°€ë„)
    localparam WEIGHT_R = 8'd77;   // 0.299 Ã— 256
    localparam WEIGHT_G = 8'd150;  // 0.587 Ã— 256  
    localparam WEIGHT_B = 8'd29;   // 0.114 Ã— 256
    
    always @(posedge clk) begin
        if (rst) begin
            gray <= 8'h0;
            de_g <= 1'b0;
            hs_g <= 1'b0;
            vs_g <= 1'b0;
        end else begin
            // ê°€ì¤‘ í‰ê·  ê³„ì‚°
            gray <= ((in_r * WEIGHT_R) + 
                     (in_g * WEIGHT_G) + 
                     (in_b * WEIGHT_B)) >> 8;
            
            // ë™ê¸°í™” ì‹ í˜¸ ì „ë‹¬
            de_g <= in_de;
            hs_g <= in_hsync;
            vs_g <= in_vsync;
        end
    end
    
endmodule
```

#### **ë™ì‘ ì›ë¦¬**
1. **ê°€ì¤‘ì¹˜ ê³±ì…ˆ**: ê° ìƒ‰ìƒ ì±„ë„ì— ê°€ì¤‘ì¹˜ ì ìš©
2. **í•©ì‚°**: ê°€ì¤‘ì¹˜ê°€ ì ìš©ëœ ìƒ‰ìƒê°’ë“¤ì„ í•©ì‚°
3. **ì •ê·œí™”**: 256ìœ¼ë¡œ ë‚˜ëˆ„ì–´ 8ë¹„íŠ¸ ë²”ìœ„ë¡œ ì¡°ì •
4. **ë™ê¸°í™”**: ì…ë ¥ ì‹ í˜¸ë¥¼ ì¶œë ¥ìœ¼ë¡œ ì „ë‹¬

### **2. 3Ã—3 Line Buffer Module**

#### **êµ¬í˜„ ì½”ë“œ**
```verilog
module linebuffer_3x3(
    input wire clk, rst,
    input wire [7:0] gray,
    input wire de_g, hs_g, vs_g,
    output reg [7:0] p00, p01, p02,
                      p10, p11, p12,
                      p20, p21, p22,
    output reg de_w, hs_w, vs_w
);
    
    // 3ë¼ì¸ ë²„í¼ (640í”½ì…€ Ã— 3ë¼ì¸)
    reg [7:0] line1 [0:639];
    reg [7:0] line2 [0:639];
    reg [7:0] line3 [0:639];
    
    // ë¼ì¸ í¬ì¸í„° (ìˆœí™˜)
    reg [1:0] line_ptr;
    
    // ì»¬ëŸ¼ ì¹´ìš´í„°
    reg [9:0] col_cnt;
    
    always @(posedge clk) begin
        if (rst) begin
            line_ptr <= 2'b0;
            col_cnt <= 10'b0;
            // ë²„í¼ ì´ˆê¸°í™”
            for (integer i = 0; i < 640; i = i + 1) begin
                line1[i] <= 8'h0;
                line2[i] <= 8'h0;
                line3[i] <= 8'h0;
            end
        end else begin
            if (de_g) begin
                // í˜„ì¬ ë¼ì¸ì— í”½ì…€ ì €ì¥
                case (line_ptr)
                    2'b00: line1[col_cnt] <= gray;
                    2'b01: line2[col_cnt] <= gray;
                    2'b10: line3[col_cnt] <= gray;
                endcase
                
                // ì»¬ëŸ¼ ì¹´ìš´í„° ì¦ê°€
                if (col_cnt == 10'd639) begin
                    col_cnt <= 10'b0;
                    // ë¼ì¸ ì™„ì„± ì‹œ í¬ì¸í„° ìˆœí™˜
                    line_ptr <= (line_ptr == 2'b10) ? 2'b00 : line_ptr + 1;
                end else begin
                    col_cnt <= col_cnt + 1;
                end
            end
            
            // 3Ã—3 ìœˆë„ìš° êµ¬ì„±
            if (de_g && col_cnt >= 10'd1) begin
                case (line_ptr)
                    2'b00: begin  // line1ì´ í˜„ì¬ ë¼ì¸
                        p00 <= line2[col_cnt-1]; p01 <= line2[col_cnt]; p02 <= line2[col_cnt+1];
                        p10 <= line3[col_cnt-1]; p11 <= line3[col_cnt]; p12 <= line3[col_cnt+1];
                        p20 <= line1[col_cnt-1]; p21 <= line1[col_cnt]; p22 <= line1[col_cnt+1];
                    end
                    2'b01: begin  // line2ê°€ í˜„ì¬ ë¼ì¸
                        p00 <= line3[col_cnt-1]; p01 <= line3[col_cnt]; p02 <= line3[col_cnt+1];
                        p10 <= line1[col_cnt-1]; p11 <= line1[col_cnt]; p12 <= line1[col_cnt+1];
                        p20 <= line2[col_cnt-1]; p21 <= line2[col_cnt]; p22 <= line2[col_cnt+1];
                    end
                    2'b10: begin  // line3ê°€ í˜„ì¬ ë¼ì¸
                        p00 <= line1[col_cnt-1]; p01 <= line1[col_cnt]; p02 <= line1[col_cnt+1];
                        p10 <= line2[col_cnt-1]; p11 <= line2[col_cnt]; p12 <= line2[col_cnt+1];
                        p20 <= line3[col_cnt-1]; p21 <= line3[col_cnt]; p22 <= line3[col_cnt+1];
                    end
                endcase
            end
            
            // ì¶œë ¥ ì‹ í˜¸ ì „ë‹¬
            de_w <= de_g;
            hs_w <= hs_g;
            vs_w <= vs_g;
        end
    end
    
endmodule
```

#### **ë™ì‘ ì›ë¦¬**
1. **ë¼ì¸ ì €ì¥**: 3ê°œ ë¼ì¸ì„ ìˆœí™˜í•˜ë©° ì €ì¥
2. **ìœˆë„ìš° êµ¬ì„±**: 3Ã—3 í”½ì…€ ìœˆë„ìš° ì‹¤ì‹œê°„ ìƒì„±
3. **ê²½ê³„ ì²˜ë¦¬**: ì´ë¯¸ì§€ ê²½ê³„ì—ì„œì˜ íŠ¹ìˆ˜ ì²˜ë¦¬
4. **ë™ê¸°í™”**: ì…ë ¥/ì¶œë ¥ ì‹ í˜¸ ë™ê¸°í™”

### **3. Sobel Core Module**

#### **êµ¬í˜„ ì½”ë“œ**
```verilog
module sobel_core(
    input wire clk, rst,
    input wire [7:0] p00, p01, p02,
                      p10, p11, p12,
                      p20, p21, p22,
    input wire de_w, hs_w, vs_w,
    output reg [7:0] sobel_mag,
    output reg de_s, hs_s, vs_s
);
    
    // Xë°©í–¥ Sobel ê³„ì‚°
    wire [9:0] gx;
    assign gx = (p02 + (p12 << 1) + p22) - (p00 + (p10 << 1) + p20);
    
    // Yë°©í–¥ Sobel ê³„ì‚°
    wire [9:0] gy;
    assign gy = (p20 + (p21 << 1) + p22) - (p00 + (p01 << 1) + p02);
    
    // ì ˆëŒ“ê°’ ê³„ì‚°
    wire [9:0] gx_abs, gy_abs;
    assign gx_abs = (gx[9]) ? (~gx + 1) : gx;  // 2's complement
    assign gy_abs = (gy[9]) ? (~gy + 1) : gy;  // 2's complement
    
    // Magnitude ê³„ì‚° (ê·¼ì‚¬ê°’)
    wire [9:0] max_val, min_val;
    assign max_val = (gx_abs > gy_abs) ? gx_abs : gy_abs;
    assign min_val = (gx_abs > gy_abs) ? gy_abs : gx_abs;
    
    always @(posedge clk) begin
        if (rst) begin
            sobel_mag <= 8'h0;
            de_s <= 1'b0;
            hs_s <= 1'b0;
            vs_s <= 1'b0;
        end else begin
            // Magnitude = max + min/2 (ê·¼ì‚¬ê°’)
            sobel_mag <= (max_val + (min_val >> 1)) > 10'd255 ? 8'hFF : 
                        (max_val + (min_val >> 1))[7:0];
            
            // ë™ê¸°í™” ì‹ í˜¸ ì „ë‹¬
            de_s <= de_w;
            hs_s <= hs_w;
            vs_s <= vs_w;
        end
    end
    
endmodule
```

#### **ë™ì‘ ì›ë¦¬**
1. **Xë°©í–¥ ê³„ì‚°**: Gx = (P6+2P7+P8) - (P0+2P1+P2)
2. **Yë°©í–¥ ê³„ì‚°**: Gy = (P2+2P5+P8) - (P0+2P3+P6)
3. **ì ˆëŒ“ê°’**: 2's complementë¥¼ ì´ìš©í•œ ë¶€í˜¸ ì œê±°
4. **Magnitude**: ê·¼ì‚¬ê°’ì„ ì´ìš©í•œ ë¹ ë¥¸ ê³„ì‚°

### **4. Threshold Module**

#### **êµ¬í˜„ ì½”ë“œ**
```verilog
module threshold_logic(
    input wire clk, rst,
    input wire [7:0] sobel_mag,
    input wire de_s, hs_s, vs_s,
    output reg [7:0] edge_bin,
    output reg de_out, hs_out, vs_out
);
    
    // ì„ê³„ê°’ ì„¤ì • (ë™ì  ì¡°ì • ê°€ëŠ¥)
    reg [7:0] threshold;
    
    always @(posedge clk) begin
        if (rst) begin
            threshold <= 8'd50;  // ê¸°ë³¸ ì„ê³„ê°’
            edge_bin <= 8'h0;
            de_out <= 1'b0;
            hs_out <= 1'b0;
            vs_out <= 1'b0;
        end else begin
            // ì´ì§„í™”: ì„ê³„ê°’ ê¸°ì¤€ ì—£ì§€ íŒì •
            edge_bin <= (sobel_mag > threshold) ? 8'hFF : 8'h00;
            
            // ë™ê¸°í™” ì‹ í˜¸ ì „ë‹¬
            de_out <= de_s;
            hs_out <= hs_s;
            vs_out <= vs_s;
        end
    end
    
endmodule
```

#### **ë™ì‘ ì›ë¦¬**
1. **ì„ê³„ê°’ ë¹„êµ**: Sobel magnitudeì™€ ì„ê³„ê°’ ë¹„êµ
2. **ì´ì§„í™”**: ì—£ì§€ ì—¬ë¶€ë¥¼ 0/255ë¡œ íŒì •
3. **ë…¸ì´ì¦ˆ ì œê±°**: ì•½í•œ ì—£ì§€ í•„í„°ë§
4. **ë™ì  ì¡°ì •**: ì‹¤ì‹œê°„ ì„ê³„ê°’ ë³€ê²½ ê°€ëŠ¥

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ë²¤ì¹˜ í”„ë¡œì„¸ìŠ¤

### **1. í…ŒìŠ¤íŠ¸ë²¤ì¹˜ êµ¬ì¡°**

#### **ê¸°ë³¸ êµ¬ì„±**
```verilog
module tb_sobel_direct;
    
    // í´ëŸ­ ë° ë¦¬ì…‹ ì‹ í˜¸
    reg clk;
    reg rst_n;
    
    // ì…ë ¥ ì‹ í˜¸
    reg [7:0] in_r, in_g, in_b;
    reg in_de, in_hsync, in_vsync;
    
    // ì¶œë ¥ ì‹ í˜¸
    wire [7:0] out_r, out_g, out_b;
    wire out_de, out_hsync, out_vsync;
    
    // DUT ì¸ìŠ¤í„´ìŠ¤
    sobel_module dut(
        .clk(clk),
        .rst_n(rst_n),
        .in_r(in_r), .in_g(in_g), .in_b(in_b),
        .in_de(in_de), .in_hsync(in_hsync), .in_vsync(in_vsync),
        .out_r(out_r), .out_g(out_g), .out_b(out_b),
        .out_de(out_de), .out_hsync(out_hsync), .out_vsync(out_vsync)
    );
    
endmodule
```

### **2. í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**

#### **ì‹œë‚˜ë¦¬ì˜¤ 1: ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸**
```
1. ë¦¬ì…‹ ì‹ í˜¸ í…ŒìŠ¤íŠ¸
   - rst_n = 0 â†’ ëª¨ë“  ì‹ í˜¸ ì´ˆê¸°í™”
   - rst_n = 1 â†’ ì •ìƒ ë™ì‘ ì‹œì‘
   
2. ë‹¨ì¼ í”½ì…€ í…ŒìŠ¤íŠ¸
   - ê³ ì • í”½ì…€ê°’ ì…ë ¥
   - ì¶œë ¥ê°’ ê²€ì¦
   
3. ì—°ì† í”½ì…€ í…ŒìŠ¤íŠ¸
   - ìˆœì°¨ì  í”½ì…€ ì…ë ¥
   - íŒŒì´í”„ë¼ì¸ ì§€ì—° í™•ì¸
```

#### **ì‹œë‚˜ë¦¬ì˜¤ 2: ì´ë¯¸ì§€ íŒŒì¼ í…ŒìŠ¤íŠ¸**
```
1. ì´ë¯¸ì§€ ë¡œë“œ
   - input.hex íŒŒì¼ ì½ê¸°
   - 640Ã—480 í”½ì…€ ë°ì´í„° ë¡œë“œ
   
2. ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬
   - í”½ì…€ ë‹¨ìœ„ ìˆœì°¨ ì…ë ¥
   - ë™ê¸°í™” ì‹ í˜¸ ìƒì„±
   
3. ê²°ê³¼ ì €ì¥
   - output.hex íŒŒì¼ ìƒì„±
   - ì²˜ë¦¬ëœ í”½ì…€ ìˆ˜ í™•ì¸
```

#### **ì‹œë‚˜ë¦¬ì˜¤ 3: ê²½ê³„ ì¡°ê±´ í…ŒìŠ¤íŠ¸**
```
1. ì´ë¯¸ì§€ ê²½ê³„ ì²˜ë¦¬
   - ì²« ë²ˆì§¸/ë§ˆì§€ë§‰ í”½ì…€
   - ì²« ë²ˆì§¸/ë§ˆì§€ë§‰ ë¼ì¸
   
2. ë™ê¸°í™” ì‹ í˜¸ í…ŒìŠ¤íŠ¸
   - HSYNC, VSYNC íƒ€ì´ë°
   - DE ì‹ í˜¸ ìœ íš¨ì„±
   
3. í´ëŸ­ ë„ë©”ì¸ í…ŒìŠ¤íŠ¸
   - í´ëŸ­ ì£¼íŒŒìˆ˜ ë³€í™”
   - ë©”íƒ€ìŠ¤í…Œì´ë¸” ë°©ì§€
```

### **3. í…ŒìŠ¤íŠ¸ í”„ë¡œì„¸ìŠ¤**

#### **ë‹¨ê³„ 1: ì»´íŒŒì¼**
```bash
# Icarus Verilog ì»´íŒŒì¼
iverilog -o sim sobel_module.v tb_sobel_direct.v
```

#### **ë‹¨ê³„ 2: ì‹œë®¬ë ˆì´ì…˜**
```bash
# VVP ì‹œë®¬ë ˆì´í„° ì‹¤í–‰
vvp sim
```

#### **ë‹¨ê³„ 3: ê²°ê³¼ ë¶„ì„**
```bash
# VCD íŒŒì¼ ìƒì„± í™•ì¸
ls -la *.vcd

# GTKWaveë¡œ íŒŒí˜• ë¶„ì„ (ì„ íƒì‚¬í•­)
gtkwave sobel_direct.vcd
```

### **4. í…ŒìŠ¤íŠ¸ ê²°ê³¼ ê²€ì¦**

#### **ì •ëŸ‰ì  ê²€ì¦**
```
1. í”½ì…€ ì²˜ë¦¬ ìˆ˜
   - ì…ë ¥: 307,200 í”½ì…€ (640Ã—480)
   - ì¶œë ¥: 307,200 í”½ì…€
   - ì²˜ë¦¬ íš¨ìœ¨ì„±: 100%

2. ì²˜ë¦¬ ì†ë„
   - í´ëŸ­ ì£¼íŒŒìˆ˜: 100MHz
   - í”½ì…€ë‹¹ í´ëŸ­ ìˆ˜: 1
   - ìµœëŒ€ ì²˜ë¦¬ ì†ë„: 100M í”½ì…€/ì´ˆ

3. ì •í™•ë„
   - ì—£ì§€ ê²€ì¶œ ì •í™•ë„
   - ë…¸ì´ì¦ˆ ì œê±° íš¨ê³¼
   - ê²½ê³„ ì²˜ë¦¬ í’ˆì§ˆ
```

#### **ì •ì„±ì  ê²€ì¦**
```
1. ì´ë¯¸ì§€ í’ˆì§ˆ
   - ì—£ì§€ ì„ ëª…ë„
   - ë…¸ì´ì¦ˆ ìˆ˜ì¤€
   - ì•„í‹°íŒ©íŠ¸ ì¡´ì¬ ì—¬ë¶€

2. ì‹¤ì‹œê°„ ì„±ëŠ¥
   - ì§€ì—° ì‹œê°„
   - ì²˜ë¦¬ ì•ˆì •ì„±
   - ë™ê¸°í™” ì •í™•ë„
```

---

## ğŸ“Š ì„±ëŠ¥ ë¶„ì„

### **1. ì²˜ë¦¬ ì„±ëŠ¥**

#### **ì²˜ë¦¬ëŸ‰ (Throughput)**
```
- ì…ë ¥ í•´ìƒë„: 640Ã—480 = 307,200 í”½ì…€
- í´ëŸ­ ì£¼íŒŒìˆ˜: 100MHz
- í”½ì…€ë‹¹ í´ëŸ­: 1
- ìµœëŒ€ ì²˜ë¦¬ëŸ‰: 100M í”½ì…€/ì´ˆ
- ì‹¤ì‹œê°„ ì²˜ë¦¬: 30fps @ 640Ã—480 ì§€ì›
```

#### **ì§€ì—° ì‹œê°„ (Latency)**
```
- íŒŒì´í”„ë¼ì¸ ë‹¨ê³„: 4ë‹¨ê³„
- ê° ë‹¨ê³„ ì§€ì—°: 1 í´ëŸ­
- ì´ ì§€ì—°: 4 í´ëŸ­ = 40ns @ 100MHz
- ì‹¤ì‹œê°„ ì‘ë‹µ: ì¦‰ì‹œ ì²˜ë¦¬ ê°€ëŠ¥
```

### **2. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰**

#### **FPGA ë¦¬ì†ŒìŠ¤**
```
- LUT ì‚¬ìš©ëŸ‰: ì•½ 2,000ê°œ
- FF ì‚¬ìš©ëŸ‰: ì•½ 1,500ê°œ
- BRAM ì‚¬ìš©ëŸ‰: ì•½ 3ê°œ (36Kb)
- DSP ì‚¬ìš©ëŸ‰: ì•½ 20ê°œ
```

#### **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**
```
- ë¼ì¸ ë²„í¼: 3Ã—640Ã—8ë¹„íŠ¸ = 1.92KB
- ì„ì‹œ ì €ì¥: 1KB
- ì´ ë©”ëª¨ë¦¬: ì•½ 3KB
```

### **3. ì „ë ¥ ì†Œëª¨**

#### **ë™ì  ì „ë ¥**
```
- í´ëŸ­ ì£¼íŒŒìˆ˜: 100MHz
- í† ê¸€ìœ¨: 50%
- ë™ì  ì „ë ¥: ì•½ 100mW
```

#### **ì •ì  ì „ë ¥**
```
- ëˆ„ì„¤ ì „ë¥˜: ì•½ 10mA
- ì •ì  ì „ë ¥: ì•½ 100mW
- ì´ ì „ë ¥: ì•½ 200mW
```

---

## ğŸš€ ìµœì í™” ê¸°ë²•

### **1. ì•Œê³ ë¦¬ì¦˜ ìµœì í™”**

#### **ê·¼ì‚¬ê°’ ì‚¬ìš©**
```verilog
// ì •í™•í•œ ì œê³±ê·¼ ëŒ€ì‹  ê·¼ì‚¬ê°’ ì‚¬ìš©
// Magnitude = âˆš(GxÂ² + GyÂ²) â‰ˆ max(|Gx|, |Gy|) + min(|Gx|, |Gy|)/2

wire [9:0] max_val, min_val;
assign max_val = (gx_abs > gy_abs) ? gx_abs : gy_abs;
assign min_val = (gx_abs > gy_abs) ? gy_abs : gx_abs;
assign magnitude = max_val + (min_val >> 1);
```

#### **ë¹„íŠ¸ ì‹œí”„íŠ¸ ì—°ì‚°**
```verilog
// ê³±ì…ˆ ëŒ€ì‹  ì‹œí”„íŠ¸ ì—°ì‚° ì‚¬ìš©
// 2Ã—P = P << 1
// P/2 = P >> 1

assign gx = (p02 + (p12 << 1) + p22) - (p00 + (p10 << 1) + p20);
```

### **2. í•˜ë“œì›¨ì–´ ìµœì í™”**

#### **íŒŒì´í”„ë¼ì¸ êµ¬ì¡°**
```verilog
// 4ë‹¨ê³„ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ì²˜ë¦¬ëŸ‰ í–¥ìƒ
always @(posedge clk) begin
    // Stage 1: RGB to Gray
    gray <= rgb2gray_calc(in_r, in_g, in_b);
    
    // Stage 2: Line Buffer Update
    line_buffer[write_ptr][col] <= gray;
    
    // Stage 3: Sobel Calculation
    sobel_result <= sobel_calc(window);
    
    // Stage 4: Threshold & Output
    edge_result <= threshold_logic(sobel_result);
end
```

#### **ë³‘ë ¬ ì²˜ë¦¬**
```verilog
// X, Y ë°©í–¥ ë™ì‹œ ê³„ì‚°
wire [9:0] gx, gy;
assign gx = (p02 + (p12 << 1) + p22) - (p00 + (p10 << 1) + p20);
assign gy = (p20 + (p21 << 1) + p22) - (p00 + (p01 << 1) + p02);
```

### **3. ë©”ëª¨ë¦¬ ìµœì í™”**

#### **ìˆœí™˜ ë²„í¼**
```verilog
// 3ë¼ì¸ë§Œ ì €ì¥í•˜ì—¬ ë©”ëª¨ë¦¬ ì ˆì•½
reg [1:0] write_ptr = 0;
always @(posedge clk) begin
    if (new_line) begin
        write_ptr <= (write_ptr + 1) % 3;
    end
end
```

#### **ë©”ëª¨ë¦¬ ì ‘ê·¼ ìµœì†Œí™”**
```verilog
// í•œ ë²ˆì˜ ë©”ëª¨ë¦¬ ì½ê¸°ë¡œ 3Ã—3 ìœˆë„ìš° êµ¬ì„±
always @(posedge clk) begin
    if (window_ready) begin
        window[0] <= {line1[col-1], line1[col], line1[col+1]};
        window[1] <= {line2[col-1], line2[col], line2[col+1]};
        window[2] <= {line3[col-1], line3[col], line3[col+1]};
    end
end
```

---

## ğŸ“ ê²°ë¡ 

### **ì„±ê³¼ ìš”ì•½**
1. **ì‹¤ì‹œê°„ ì²˜ë¦¬**: 640Ã—480 @ 30fps ì§€ì›
2. **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: 3KBë¡œ ì „ì²´ ì´ë¯¸ì§€ ì²˜ë¦¬
3. **ì •í™•ë„**: ë…¸ì´ì¦ˆì— ê°•í•œ ì—£ì§€ ê²€ì¶œ
4. **í™•ì¥ì„±**: ë‹¤ì–‘í•œ í•´ìƒë„ ë° ì„ê³„ê°’ ì§€ì›

### **í–¥í›„ ê°œì„  ë°©í–¥**
1. **ë‹¤ì¤‘ ìŠ¤ì¼€ì¼**: ë‹¤ì–‘í•œ í•´ìƒë„ ì§€ì›
2. **ì ì‘í˜• ì„ê³„ê°’**: ì´ë¯¸ì§€ íŠ¹ì„±ì— ë”°ë¥¸ ìë™ ì¡°ì •
3. **í•˜ë“œì›¨ì–´ ê°€ì†**: DSP ë¸”ë¡ í™œìš©
4. **ì‹¤ì‹œê°„ ì œì–´**: ë™ì  íŒŒë¼ë¯¸í„° ì¡°ì •

### **ì ìš© ë¶„ì•¼**
1. **ìë™ì°¨**: ì°¨ì„  ê²€ì¶œ, ì¥ì• ë¬¼ ì¸ì‹
2. **ì˜ë£Œ**: ì˜ë£Œ ì˜ìƒ ë¶„ì„
3. **ì œì¡°ì—…**: í’ˆì§ˆ ê²€ì‚¬, ê²°í•¨ ê²€ì¶œ
4. **ë³´ì•ˆ**: ëª¨ì…˜ ê°ì§€, ì¹¨ì… íƒì§€

---

## ğŸ“š ì°¸ê³  ìë£Œ

### **ë…¼ë¬¸ ë° ê¸°ìˆ  ë¬¸ì„œ**
1. "Digital Image Processing" - Gonzalez & Woods
2. "FPGA Implementation of Sobel Edge Detection" - IEEE
3. "Real-time Image Processing on FPGA" - Springer

### **ê´€ë ¨ í‘œì¤€**
1. **VGA**: 640Ã—480 @ 60Hz
2. **HDMI**: 1920Ã—1080 @ 60Hz
3. **Camera Interface**: MIPI, DVP, BT656

### **ê°œë°œ ë„êµ¬**
1. **HDL**: Verilog, VHDL, SystemVerilog
2. **ì‹œë®¬ë ˆì´ì…˜**: ModelSim, Icarus Verilog, GTKWave
3. **í•©ì„±**: Xilinx Vivado, Intel Quartus

---

*ì´ ë¬¸ì„œëŠ” Sobel ì—£ì§€ ê²€ì¶œ í•„í„°ì˜ í•˜ë“œì›¨ì–´ êµ¬í˜„ì— ëŒ€í•œ ìƒì„¸í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.*
