# AI Fourcut 프로젝트 - ISP_Top 전체 시스템 아키텍처

## 📋 개요
ISP_Top은 AI Fourcut 프로젝트의 최상위 모듈로, 카메라 입력부터 VGA 출력까지의 전체 이미지 처리 파이프라인을 관리합니다.

## 🏗️ 시스템 아키텍처

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   OV7670        │    │   Filter_Top    │    │   Frame_Buffer  │
│   Camera        │───▶│   (Image        │───▶│   (Dual-Port    │
│   Input         │    │    Processing)   │    │    Memory)      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │                       │                       ▼
         │                       │              ┌─────────────────┐
         │                       │              │   VGA_         │
         │                       │              │   MemController│
         │                       │              └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   SCCB          │    │   UART          │    │   VGA_Decoder  │
│   (Camera       │    │   (Remote       │    │   (Display     │
│    Control)     │    │    Control)      │    │    Timing)     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 🔧 주요 구성 요소

### 1. **입력 시스템**
- **OV7670 카메라**: 320x240 RGB565 포맷으로 이미지 캡처
- **SCCB 통신**: 카메라 설정 및 초기화
- **OV7670_MemController**: 카메라 데이터를 메모리에 저장

### 2. **이미지 처리 시스템**
- **Filter_Top**: 11가지 필터 중 선택적 적용
- **Frame_Buffer**: 듀얼 포트 메모리로 읽기/쓰기 분리

### 3. **출력 시스템**
- **VGA_MemController**: 메모리에서 픽셀 데이터 읽기
- **VGA_Decoder**: VGA 타이밍 신호 생성
- **VGA 출력**: 640x480 RGB444 포맷

### 4. **제어 시스템**
- **UART**: 원격 제어 (필터 선택, 디스플레이 모드)
- **로컬 제어**: 스위치와 버튼 입력

## 📊 신호 흐름

### **카메라 → 메모리**
```
OV7670 → OV7670_MemController → Frame_Buffer (Write)
```

### **메모리 → 디스플레이**
```
Frame_Buffer (Read) → VGA_MemController → VGA_Decoder → VGA 출력
```

### **이미지 처리**
```
카메라 데이터 → Filter_Top → 필터 적용 → Frame_Buffer
```

## 🎛️ 제어 인터페이스

### **UART 명령어**
- `0-9, .`: 필터 선택 (0=원본, 1=Gaussian, ..., .=Sticker)
- `z, x, c`: 디스플레이 모드 (z=원본, x=풀스크린, c=4컷)
- `s, w, a, d`: 버튼 제어 (s=리셋, w=스티커, a=왼쪽, d=오른쪽)

### **로컬 제어**
- `sel[3:0]`: 필터 선택
- `vga_sw[1:0]`: 디스플레이 모드
- `btn_*`: 버튼 입력

## ⚡ 타이밍 특성

### **클럭 도메인**
- **카메라 도메인**: `ov7670_pclk` (카메라 픽셀 클럭)
- **시스템 도메인**: `clk` (100MHz)
- **VGA 도메인**: `vga_pclk` (25MHz)

### **메모리 인터페이스**
- **쓰기**: 카메라 클럭 도메인
- **읽기**: VGA 클럭 도메인
- **듀얼 포트**: 동시 읽기/쓰기 가능

## 🔍 핵심 설계 원리

### **1. 파이프라인 구조**
- 카메라 입력과 VGA 출력이 독립적으로 동작
- Frame_Buffer가 중간 버퍼 역할

### **2. 모듈화 설계**
- 각 기능별로 독립적인 모듈
- 명확한 인터페이스 정의

### **3. 실시간 처리**
- 하드웨어 기반 실시간 이미지 처리
- 소프트웨어 지연 없음

## 🎯 학습 포인트

1. **시스템 레벨 설계**: 전체 시스템의 아키텍처 이해
2. **클럭 도메인**: 서로 다른 클럭 도메인 간의 데이터 전송
3. **메모리 관리**: 듀얼 포트 메모리의 활용
4. **실시간 처리**: 하드웨어 기반 실시간 이미지 처리
5. **모듈화**: 재사용 가능한 모듈 설계

## 📝 다음 단계
- `02_Filter_Top_Architecture.md`: 필터 시스템 상세 분석
- `07_Frame_Buffer_System.md`: 메모리 시스템 분석
- `11_VGA_Display_System.md`: 디스플레이 시스템 분석
